<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geolocation Path Visualization</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #121212;
            color: #ffffff;
            font-family: Arial, sans-serif;
            height: 100vh;
            overflow: hidden;
        }
        #defaultCanvas0 {
            display: block;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.6.0/p5.js"></script>
</head>
<body>
    <script>
        let path = []; // 이동 경로를 저장할 배열
        let isLocationLoaded = false;

        function setup() {
            createCanvas(800, 600);
            textAlign(CENTER, CENTER);
            textSize(16);

            if (navigator.geolocation) {
                navigator.geolocation.watchPosition(
                    (position) => {
                        const latitude = position.coords.latitude;
                        const longitude = position.coords.longitude;
                        const accuracy = position.coords.accuracy;
                        isLocationLoaded = true;

                        // 경로 데이터 저장
                        path.push({
                            latitude: latitude,
                            longitude: longitude,
                            accuracy: accuracy,
                        });
                    },
                    (error) => {
                        console.error("위치 정보를 가져올 수 없습니다.", error);
                    },
                    {
                        enableHighAccuracy: true,
                    }
                );
            } else {
                console.error("Geolocation API를 지원하지 않는 브라우저입니다.");
            }
        }

        function draw() {
            background(30);

            if (isLocationLoaded && path.length > 1) {
                noFill();
                stroke(0, 200, 100);
                strokeWeight(2);

                // 경로를 선으로 그리기
                beginShape();
                for (let point of path) {
                    const x = map(point.longitude, -180, 180, 0, width);
                    const y = map(point.latitude, 90, -90, 0, height);
                    vertex(x, y);
                }
                endShape();

                // 마지막 위치 표시
                const lastPoint = path[path.length - 1];
                fill(255, 0, 0);
                const lastX = map(lastPoint.longitude, -180, 180, 0, width);
                const lastY = map(lastPoint.latitude, 90, -90, 0, height);
                ellipse(lastX, lastY, 10, 10);

                fill(255);
                text(
                    `현재 위치\n위도: ${lastPoint.latitude.toFixed(4)}\n경도: ${lastPoint.longitude.toFixed(4)}\n정확도: ${lastPoint.accuracy.toFixed(1)}m`,
                    width / 2,
                    height - 50
                );
            } else {
                fill(255);
                text("위치 데이터를 불러오는 중...", width / 2, height / 2);
            }
        }
    </script>
</body>
</html>
